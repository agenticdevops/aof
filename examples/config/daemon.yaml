# AOF Daemon Configuration
#
# Configuration for AOF daemon server.
#
# Prerequisites:
#   Set environment variables for enabled platforms:
#   - Slack:    SLACK_BOT_TOKEN, SLACK_SIGNING_SECRET
#   - Telegram: TELEGRAM_BOT_TOKEN
#   - LLM:      GOOGLE_API_KEY (or ANTHROPIC_API_KEY/OPENAI_API_KEY)
#
# Usage:
#   export SLACK_BOT_TOKEN=xoxb-xxxxx
#   export SLACK_SIGNING_SECRET=xxxxx
#   export TELEGRAM_BOT_TOKEN=xxxxx
#   export GOOGLE_API_KEY=xxxxx
#
#   aofctl serve --config examples/config/daemon.yaml
#
# Expose webhooks (choose one):
#   # Cloudflared (recommended - no signup needed):
#   brew install cloudflared
#   cloudflared tunnel --url http://localhost:3000
#
#   # Or ngrok (requires free account):
#   ngrok http 3000
#
# Webhook URLs:
#   Slack:    https://your-tunnel-url/webhook/slack
#   Telegram: https://your-tunnel-url/webhook/telegram

apiVersion: aof.dev/v1
kind: DaemonConfig
metadata:
  name: aof-daemon
  labels:
    environment: development

spec:
  # =============================================================================
  # Server Configuration
  # =============================================================================
  server:
    port: 3000
    host: 0.0.0.0
    cors: true
    timeout_secs: 60

  # =============================================================================
  # Platform Integrations
  # Enable/disable platforms as needed. Only enabled platforms require env vars.
  #
  # NOTE: In future versions, platform config will move entirely to Trigger files.
  # For now, platforms must be enabled here for the webhook endpoints to work.
  # =============================================================================
  platforms:
    # Slack Bot
    # Setup: https://api.slack.com/apps → Create App → Enable Event Subscriptions
    slack:
      enabled: true
      bot_token_env: SLACK_BOT_TOKEN
      signing_secret_env: SLACK_SIGNING_SECRET

    # Telegram Bot
    # Setup: Message @BotFather on Telegram → /newbot
    telegram:
      enabled: true
      bot_token_env: TELEGRAM_BOT_TOKEN

  # =============================================================================
  # Triggers Configuration
  #
  # Triggers define command bindings for platforms.
  # See examples/triggers/ for Slack, Telegram examples.
  # =============================================================================
  triggers:
    directory: ./examples/triggers/
    watch: false

  # =============================================================================
  # Agent Configuration
  # =============================================================================
  agents:
    directory: ./examples/agents/
    watch: false

  # =============================================================================
  # Fleet Configuration
  # =============================================================================
  fleets:
    directory: ./examples/fleets/
    watch: false

  # =============================================================================
  # AgentFlow Configuration (Optional)
  # =============================================================================
  flows:
    directory: ./examples/flows/
    watch: false
    enabled: true

  # =============================================================================
  # Runtime Configuration
  # =============================================================================
  runtime:
    max_concurrent_tasks: 10
    task_timeout_secs: 300
    max_tasks_per_user: 5
    default_agent: devops
