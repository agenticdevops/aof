# AOF Telegram Bot Configuration
#
# Usage:
#   aofctl serve --config examples/configs/telegram-bot.yaml
#
# Required Environment Variables:
#   - TELEGRAM_BOT_TOKEN: Bot token from @BotFather
#   - GOOGLE_API_KEY: Google AI API key for Gemini model
#
# Directory Structure:
#   ./agents/           - Agent YAML files (k8s-ops.yaml, etc.)
#   ./flows/            - AgentFlow YAML files (telegram-default.yaml, etc.)
#
apiVersion: aof.dev/v1
kind: DaemonConfig
metadata:
  name: telegram-trigger-server
  labels:
    platform: telegram
    environment: development

spec:
  server:
    port: 8080
    host: "0.0.0.0"
    cors: true
    timeout_secs: 30

  platforms:
    telegram:
      enabled: true
      # Set via environment variable: TELEGRAM_BOT_TOKEN
      bot_token_env: "TELEGRAM_BOT_TOKEN"
      # Optional: webhook secret for verification (set in BotFather)
      webhook_secret: null

  # Agent discovery - loads all kind: Agent from this directory
  agents:
    directory: "./agents"
    watch: false

  # AgentFlow routing - determines which agent handles which messages
  flows:
    directory: "./flows"
    watch: false
    enabled: true

  runtime:
    max_concurrent_tasks: 10
    task_timeout_secs: 300
    max_tasks_per_user: 3
    # Default agent when no AgentFlow matches (fallback)
    # Must exist in agents.directory as "metadata.name: k8s-ops"
    default_agent: "k8s-ops"
